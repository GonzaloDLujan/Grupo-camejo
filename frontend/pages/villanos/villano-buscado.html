<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <title>Perfil del Villano</title>
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bulma@1.0.4/css/bulma.min.css">
</head>
<body class="has-background-dark" style="min-height: 100vh;">
    <nav class="navbar is-dark shadow" role="navigation">
        <div class="container">
            <div class="navbar-menu">
                <div class="navbar-start">
                    <a class="navbar-item" href="index.html">Inicio</a>
                    <a class="navbar-item" href="agentes.html">Agentes</a>
                    <a class="navbar-item" href="misiones.html">Misiones</a>
                    <a class="navbar-item is-active" href="villanos.html">Villanos</a>
                </div>
            </div>
        </div>
    </nav>
    <div class="container py-6">
        <div class="columns is-centered">
            <div class="column is-6">
                <div class="card" style="border-radius: 15px; overflow: hidden;">
                    <div id="perfil-info" class="card-content">
                        </div>
                </div>
                <div class="has-text-centered mt-5">
                    <a href="villanos.html" class="button is-light is-outlined">← Volver</a>
                </div>
            </div>
        </div>
    </div>

    <script type="module">
        import { API_URL } from './funciones-villanos.js';

        const urlParams = new URLSearchParams(window.location.search);
        const id = urlParams.get('id');

        async function cargarPerfil() {
            try {
                const response = await fetch(`${API_URL}/villanos/${id}`); 
                
                if (!response.ok) throw new Error();
                const villano = await response.json();

                document.getElementById("perfil-info").innerHTML = `
                    `;
            } catch (e) {
                document.getElementById("perfil-info").innerHTML = "<p class='has-text-centered'>Error al cargar el perfil.</p>";
            }
        }

        window.eliminar = async function() {
            if(confirm("¿Seguro que desea eliminar este registro?")) {
                await fetch(`${API_URL}/villanos/${id}`, { method: 'DELETE' });
                window.location.href = "villanos.html";
            }
        }

        window.onload = cargarPerfil;

        async function eliminar() {
            if(confirm("¿Seguro que desea eliminar este registro?")) {
                await fetch(`${API_URL}/${id}`, { method: 'DELETE' });
                window.location.href = "villanos.html";
            }
        }

        window.onload = cargarPerfil;
    </script>
</body>
</html>